(this.webpackJsonpftappconfig=this.webpackJsonpftappconfig||[]).push([[4],{290:function(e,t,s){},294:function(e,t,s){},297:function(e,t,s){},306:function(e,t,s){},307:function(e,t,s){},312:function(e,t,s){"use strict";s.r(t);var n=s(29),a=s(43),o=s(10),i=s(11),l=s(15),c=s(17),r=s(0),d=s.n(r),h=s(95),p="http://localhost:"+(new URLSearchParams(window.location.search).get("backendPort")||"7878"),u="px",m=["BUTTON","EDIT","CHECKBOX","RADIO_BUTTON","DROPDOWN","LINK","IMAGE","LIST","LIST_ITEM","LABEL","SLIDER","PROGRESS_BAR","TEXTAREA"],b=(s(294),s(158),s(33)),g=s(295),f=(s(296),s(297),function(){function e(t){Object(o.a)(this,e),this.sessionId=t,this.name=null,this.startx=0,this.starty=0,this.endx=0,this.endy=0,this.startTime=0,this.buttonPressed=!1}return Object(i.a)(e,[{key:"setStartPosition",value:function(e,t){this.startx=e,this.starty=t}},{key:"setEndPosition",value:function(e,t){this.endx=e,this.endy=t}},{key:"buildActionArgs",value:function(){var e={x:this.startx,y:this.starty,selection:this.selection};return JSON.stringify(e)}}]),e}()),j=function(){function e(t){Object(o.a)(this,e),this.action=new f(t),this.zoomFactor=1}return Object(i.a)(e,[{key:"handleEvent",value:function(e,t){if(0!==e.button)return null;this.action.name=null,this.zoomFactor=t.naturalHeight/t.clientHeight;var s=t.getBoundingClientRect(),n=Math.round((e.clientX-s.left)*this.zoomFactor),a=Math.round((e.clientY-s.top)*this.zoomFactor);return console.log(n,a),this.action.setStartPosition(n,a),this.action.name="click",null===this.action.name?null:this.action}}]),e}(),C=s(291),x=s(292),v=s(28),S=s(68),O=s(119),y=s(3),I=(s(298),s(6)),N=s(2),k=function(e){var t=Object(r.useState)(null),s=Object(b.a)(t,2),n=s[0],a=s[1],o=Object(r.useState)({aspect:16/9}),i=Object(b.a)(o,2),l=i[0],c=i[1],d=Object(r.useState)(!1),p=Object(b.a)(d,2),f=p[0],k=p[1],w=Object(r.useState)(e.controlname),A=Object(b.a)(w,2),D=A[0],T=A[1],H=Object(r.useState)(e.content),F=Object(b.a)(H,2),R=F[0],P=F[1],E=Object(r.useState)(null),K=Object(b.a)(E,2),V=K[0],M=K[1],_=Object(r.useState)(),B=Object(b.a)(_,2),L=B[0],W=B[1],z=Object(r.useState)(),X=Object(b.a)(z,2),Y=X[0],q=X[1],U=Object(r.useState)(),J=Object(b.a)(U,2),G=J[0],Q=J[1],Z=Object(r.useState)(),$=Object(b.a)(Z,2),ee=$[0],te=$[1],se=Object(r.useState)(!1),ne=Object(b.a)(se,2),ae=ne[0],oe=ne[1],ie=Object(r.useState)(!0),le=Object(b.a)(ie,2),ce=le[0],re=le[1],de=Object(r.useState)(!1),he=Object(b.a)(de,2),pe=he[0],ue=he[1],me=Object(r.useRef)(null),be=Object(r.useRef)(null),ge=new j("01"),fe=navigator.userAgent.toLowerCase().includes("firefox"),je=Object(r.useState)(!1),Ce=Object(b.a)(je,2),xe=Ce[0],ve=Ce[1];Object(r.useEffect)((function(){Se(),ve(!!fe)}),[e.selection]),Object(r.useEffect)((function(){ue(!0),0===e.onHoverControlCoordinates.x&&0===e.onHoverControlCoordinates.y&&0===e.onHoverControlCoordinates.w&&0===e.onHoverControlCoordinates.h&&ue(!1)}),[e.onHoverControlCoordinates]),Object(r.useEffect)((function(){e.selectRegionFrom.add||e.selectRegionFrom.highlight||e.selectRegionFrom.reverseHighlight}),[l]);var Se=function(){if("undefined"!==typeof e.selection){var t=y.a+"/application/"+e.appId+"/images/"+e.selection+"/screenshot";Object(O.c)(t).then((function(e){if(e.data){var t="data:image/png;base64,"+e.data;a(t)}})).catch((function(e){console.log(e)}))}},Oe=function(t){var s=ge.handleEvent(t,me.current);null!==s&&(s.selection=e.selection,function(t,s){e.controlSteps.map((function(n){t.startx>=n.bounds.x&&t.starty>=n.bounds.y&&t.startx<=n.bounds.x+n.bounds.w&&t.starty<=n.bounds.y+n.bounds.h&&(e.clearAllControls(),s.ctrlKey?(e.onControlSelect(n,!1),e.updateParentControlState(n,!1)):(e.onControlSelect(n,!0),e.updateParentControlState(n,!0)))}))}(s,t))},ye=function(e){if(null===me.current)return{};var t=me.current.naturalHeight/me.current.clientHeight,s={},n=parseFloat(e.x),a=parseFloat(e.y),o=parseFloat(e.w),i=parseFloat(e.h);return s.width=o/t+u,s.height=i/t+u,s.left=n/t+u,s.top=a/t+u,delete s.right,delete s.bottom,s};if(!0===e.isImgProcessing)return Object(N.jsxs)("div",{className:"prorgressbar",children:[Object(N.jsx)("h3",{children:I.a.t("device-viewer.loader")}),Object(N.jsx)(C.a,{mode:"indeterminate",style:{height:"6px"}})]});var Ie=!0;0===e.selectedControlCoordinatesArr.length&&(Ie=!1);var Ne=function(){c(void 0),e.setEnableCrop(!1)},ke=function(){e.setRegionFrom({add:!1,highlight:!1,reverseHighlight:!1}),k(!1),e.setEnableCrop(!1),c(void 0),e.setDragComplete(!1)},we=function(){P(null),M(null),W(null),q(null),te(null),Q(null)};return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("div",{className:"highlight-items",children:[Object(N.jsx)("div",{className:"item",children:Object(N.jsx)("a",{href:"#",className:"highlight",title:"Highlight controls",onClick:function(){return e.setRegionFrom({add:!1,highlight:!0,reverseHighlight:!1}),void e.setEnableCrop(!0)},children:Object(N.jsx)("i",{className:"pi pi-eye"})})}),Object(N.jsx)("div",{className:"item",children:Object(N.jsx)("a",{href:"#",className:"highlight-reverse",title:"Highlight reverse controls",onClick:function(){return e.setRegionFrom({add:!1,highlight:!1,reverseHighlight:!0}),void e.setEnableCrop(!0)},children:Object(N.jsx)("i",{className:"pi pi-arrow-right-arrow-left"})})}),Object(N.jsx)("div",{className:"item",children:Object(N.jsx)("a",{href:"#",className:"Cancel",title:"Cancel selection",onClick:ke,children:Object(N.jsx)("i",{className:"pi pi-times-circle"})})})]}),Object(N.jsx)("div",{className:"viewer-section",children:Object(N.jsxs)("div",{className:"dv ".concat(xe?"dv-moz":"dv-chrome"),children:[Object(N.jsxs)("div",{className:"dv-content",children:[e.selection&&n&&Object(N.jsx)(N.Fragment,{children:e.addControl?Object(N.jsx)("center",{children:!!n&&Object(N.jsx)(N.Fragment,{children:Object(N.jsx)(g.a,{crop:l,onChange:function(e){!function(e){var t=document.createElement("canvas"),s=me.current.naturalHeight/me.current.clientHeight,n=parseFloat(e.x)*s,a=parseFloat(e.y)*s,o=parseFloat(e.width)*s,i=parseFloat(e.height)*s;t.width=e.width,t.height=e.height;var l=t.getContext("2d"),c=window.devicePixelRatio;t.width=e.width*c,t.height=e.height*c,l.setTransform(c,0,0,c,0,0),l.imageSmoothingQuality="high",W(n),q(a),Q(o),te(i)}(e),c(e)},onComplete:function(){return k(!0)},children:Object(N.jsx)("img",{ref:me,src:n,draggable:"false",alt:"viewer image"})})})}):Object(N.jsx)(N.Fragment,{children:!!n&&Object(N.jsx)(N.Fragment,{children:Object(N.jsx)("img",{ref:me,src:n,draggable:"false",onMouseDown:function(e){Oe(e)},alt:"viewer image"})})})}),Ie&&e.selectedControlCoordinatesArr.map((function(e){return Object(N.jsx)("div",{className:"dv-selected-control",style:ye(e)},Math.random())})),pe&&Object(N.jsx)("div",{className:"dv-selected-control-hover",style:ye(e.onHoverControlCoordinates)},Math.random()),e.hotSpotControl&&Object(N.jsxs)("div",{children:[Object(N.jsx)("div",{className:"circles",style:ye(e.hotSpotControl.bounds),children:Object(N.jsx)("div",{className:"circle1"})}),Object(N.jsx)("div",{className:"hotSpot-control",style:ye(e.hotSpotControl.bounds)},Math.random())]})]}),Object(N.jsx)(S.a,{ref:be}),Object(N.jsx)(x.a,{visible:f,position:"right",onHide:function(){return ke()},children:Object(N.jsx)("div",{className:"cd-container",children:Object(N.jsxs)("form",{className:"form",onSubmit:function(t){t.preventDefault(),function(){var t=e.controlSteps,s={type:D,content:R,confidence:"100.0",category:V,bounds:{x:Math.round(L),y:Math.round(Y),w:Math.round(G),h:Math.round(ee)}};t.map((function(e,t){delete e.isChecked})),t.push(s),e.setControlSteps(t);var n=y.a+"/application/"+e.appId+"/images/"+e.selection+"/labels";h.a.put(n,t,{headers:{"Content-Type":"application/json","if-Match":"abcd"}}).then((function(t){be.current.show({severity:"info",summary:"Confirmed",detail:I.a.t("device-viewer.control-create-success-msg"),life:3e3}),e.refreshControlLabels(),we(),e.clearAllControls(),k(!1),Ne()}))}()},children:[Object(N.jsxs)("div",{className:"control-type d-flex",children:[Object(N.jsxs)("label",{className:"l-controlname",children:[I.a.t("device-viewer.type")," "]}),Object(N.jsxs)("select",{className:"controlname-input",onChange:function(e){var t;T((t=e).target.value),M(m.indexOf(t.target.value)),re(!1)},children:[Object(N.jsx)("option",{name:"",value:0,children:I.a.t("device-viewer.select-control")}),m.map((function(e,t){return Object(N.jsx)("option",{value:e,children:e},t)}))]})]}),Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("div",{className:"control-content d-flex",children:[Object(N.jsxs)("label",{className:"l-content",children:[I.a.t("device-viewer.content")," "]}),Object(N.jsx)("input",{type:"text",label:"Control Content",className:"content-input",onChange:function(e){P(e.target.value)},value:R})]}),Object(N.jsx)("div",{className:"moreLink",onClick:function(){return oe(!ae)},children:ae?"show less":"show more"})]}),ae&&Object(N.jsxs)("div",{className:"moreSection",children:[Object(N.jsxs)("div",{className:"d-flex coordinates",children:[Object(N.jsxs)("label",{className:"l-content",children:[I.a.t("device-viewer.bounds")," "]}),Object(N.jsx)("label",{className:"l-x",children:" X "}),Object(N.jsx)("input",{type:"text",className:"x-input",value:Math.round(L),onChange:function(e){return W(e.target.value)}}),Object(N.jsx)("label",{className:"l-y",children:" Y "}),Object(N.jsx)("input",{type:"text",className:"y-input",value:Math.round(Y),onChange:function(e){return q(e.target.value)}})]}),Object(N.jsxs)("div",{className:"d-flex coordinates",children:[Object(N.jsxs)("label",{className:"l-content",style:{visibility:"hidden"},children:["Bounds"," "]}),Object(N.jsx)("label",{className:"l-w",children:" W "}),Object(N.jsx)("input",{type:"text",className:"w-input",value:Math.round(G),onChange:function(e){return Q(e.target.value)}}),Object(N.jsx)("label",{className:"l-h",children:" H "}),Object(N.jsx)("input",{type:"text",className:"h-input",value:Math.round(ee),onChange:function(e){return te(e.target.value)}})]})]}),Object(N.jsx)(v.a,{icon:"pi pi-check",type:"submit",className:"p-button-raised p-button-rounded save",label:I.a.t("device-viewer.save"),disabled:ce})]})})})]})})]})},w=s(299),A=(s(290),s(145)),D=(s(157),s(310)),T=function(e){Object(r.useEffect)((function(){var t=document.getElementById(e.selection);null!==t&&t.classList.add("selected")}),[e.presentImageIndex]);return Object(N.jsx)("div",{className:"design-tb-content ".concat(e.isExpandView?"expand-view":""),children:Object(N.jsx)(D.a,{onPosChange:function(t,s){var n={source:{index:0},destination:{index:0}};n.source.index=t,n.destination.index=s,e.handleOnDragEnd(n,e.ids)},children:e.thumbnailImages.map((function(t,s){var n=Object.values(t)[0],a=Object.keys(t)[0],o=e.selection===a?"selected":"";return Object(N.jsxs)("div",{className:"".concat(o," selectedImage"),onClick:function(t){return e.onClick(t,a,s)},tabIndex:"0",onKeyDown:function(t){return e.onKeyPressForAccessible(t)},id:"image_".concat(s),children:[Object(N.jsx)("img",{id:a,className:"thumbnail ".concat(o),alt:"thumbnail image",src:"data:image/png;base64,".concat(n)}),Object(N.jsx)("button",{type:"submit",className:"deleteThumnailImg",onClick:function(){return e.deleteDialogWidget(!0)},"aria-label":"delete image",children:Object(N.jsx)("i",{className:"pi pi-times",style:{fontSize:"10px"}})})]},s)}))})})},H=s(289),F=s(309),R=function(e){return Object(r.useEffect)((function(){var t=document.getElementById(e.selection);null!==t&&t.classList.add("selected")}),[e.presentImageIndex]),Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("div",{className:"previous-image ".concat(e.isExpandView?"d-none":""),children:Object(N.jsx)("i",{className:"pi pi-angle-left "+(e.disablePrevious?"disabled":""),style:{fontSize:"1rem",cursor:"pointer"},onClick:e.handlePreviousImage})}),Object(N.jsx)(F.a,{onDragEnd:function(t){return e.handleOnDragEnd(t,e.ids)},children:Object(N.jsx)(F.c,{droppableId:"droppableList",type:"droppableListItem",direction:"horizontal",children:function(t){return Object(N.jsxs)("div",{className:"design-tb-content ".concat(e.isExpandView?"expand-view":""),ref:t.innerRef,children:[e.thumbnailImages.map((function(t,s){var n=Object.values(t)[0],a=Object.keys(t)[0],o=e.selection===a?"selected":"";return Object(N.jsx)(F.b,{draggableId:a,index:s,children:function(t){return Object(N.jsxs)("div",Object(H.a)(Object(H.a)(Object(H.a)({ref:t.innerRef},t.draggableProps),t.dragHandleProps),{},{children:[Object(N.jsxs)("div",{className:"selectedImage",onClick:function(t){return e.onClick(t,a,s)},tabIndex:"0",onKeyDown:function(t){return e.onKeyPressForAccessible(t)},id:"image_".concat(s),children:[Object(N.jsx)("img",{id:a,className:"thumbnail ".concat(o),alt:"thumbnail image",src:"data:image/png;base64,".concat(n)}),Object(N.jsx)("button",{type:"submit",className:"deleteThumnailImg",onClick:function(){return e.deleteDialogWidget(!0)},"aria-label":"delete image",children:Object(N.jsx)("i",{className:"pi pi-times",style:{fontSize:"10px"}})})]},s),t.placeholder]}))}},a)})),t.placeholder]})}})}),Object(N.jsx)("div",{className:"next-image ".concat(e.isExpandView?"d-none":""),children:Object(N.jsx)("i",{className:"pi pi-angle-right "+(e.disableNext?"disabled":""),style:{fontSize:"1rem",cursor:"pointer"},onClick:e.handleNextImage})})]})},P=function(e){Object(l.a)(s,e);var t=Object(c.a)(s);function s(e){var a;return Object(o.a)(this,s),(a=t.call(this,e)).onClick=function(e,t,s){a.props.onNewSelection(t);var n,o=document.getElementsByClassName("thumbnail"),i=Object(w.a)(o);try{for(i.s();!(n=i.n()).done;){n.value.classList.remove("selected")}}catch(l){i.e(l)}finally{i.f()}e.target.classList.add("selected"),a.setState({presentImageIndex:s})},a.handelDeleteImg=function(e){var t=y.a+"/application/"+a.props.appId+"/images/"+a.props.selection;return h.a.delete(t).then((function(t){a.props.filterSelection(a.props.selection),a.setState({showDeleteDialog:!1});a.props.selectedImageName;var s=I.a.t("device-toolbar.delete-success-msg",{imagename:e});a.toast.current.show({severity:"success",summary:"Confirmed",detail:s,life:3e3})}))},a.deleteDialogWidget=function(e){a.setState({showDeleteDialog:e})},a.reorder=function(e,t,s){var n=e[t];return e.splice(t,1),e.splice(s,0,n),e},a.handleHotspotReorder=function(e,t){var s=a.reorder(t,e.source.index,e.destination.index);console.log("before",s);var o=a.props.allImageHotSpotDetails,i=[];s.map((function(e,t){if(null!==Object.values(e)[0]){var a=o.find((function(t){return t.imageId===Object.keys(e)[0]})),l=a.navigationData,c={};if(null!==l.navigation){var r=void 0===s[t+1]?null:Object.keys(s[t+1])[0];c=null!==r?{imageId:a.imageId,name:l.name,navigation:Object(n.a)({},Object.keys(l.navigation)[0],{click:r})}:{imageId:a.imageId,name:l.name,navigation:null}}i.push(c)}})),i.map((function(e){var t=y.a+"/application/"+a.props.appId+"/images/"+e.imageId+"/metadata",s=JSON.parse(JSON.stringify(e));delete s.imageId,h.a.put(t,s,{headers:{"Content-Type":"application/json","if-Match":"abcd"}}).then((function(t){console.log(e),a.props.getHotspot(e.imageId)})).catch((function(e){console.log(e),a.toastRef.current.show({severity:"info",summary:"Warning",detail:I.a.t("controls.hotspot-error-msg"),life:3e3})}))}))},a.handleOnDragEnd=function(e,t){var s=a.reorder(t,e.source.index,e.destination.index),n=a.reorder(a.props.thumbnailImages,e.source.index,e.destination.index);a.handleHotspotReorder(e,a.props.allImageHotSpotIds);var o=a.reorder(a.props.imageids,e.source.index,e.destination.index);a.props.setImageObjArr(n),a.props.setThumbnails(o);var i=y.a+"/application/"+a.props.appId+"/images/order";return h.a.put(i,s,{headers:{"Access-Control-Allow-Headers":"origin x-requested-with, content-type","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"*","Content-Type":"application/json"}}).then((function(e){a.toast.current.show({severity:"success",summary:"Confirmed",detail:I.a.t("device-toolbar.image-order-success"),life:3e3})}))},a.handlePreviousImage=function(){var e=a.state.presentImageIndex-1;document.getElementById("image_"+e).click(),a.setState({presentImageIndex:e})},a.handleNextImage=function(){var e=a.state.presentImageIndex+1;document.getElementById("image_"+e).click(),a.setState({presentImageIndex:e})},a.handelExpandView=function(){a.setState({isExpandView:!a.state.isExpandView})},a.state={showDeleteDialog:!1,presentImageIndex:0,disableNext:!1,disablePrevious:!0,isExpandView:!1,showExpandView:!1},a.toast=Object(r.createRef)(),a}return Object(i.a)(s,[{key:"componentDidUpdate",value:function(e,t){var s=this;if(setTimeout((function(){var e=document.getElementById(s.props.selection);null!==e&&e.scrollIntoView({behavior:"smooth",block:"center"})}),100),e.thumbnailImages!==this.props.thumbnailImages){var n=document.getElementsByClassName("design-tb-content");n[0].scrollWidth>n[0].clientWidth&&this.setState({showExpandView:!0}),this.setState({presentImageIndex:this.props.imageFocusPoint}),this.props.thumbnailImages.length>0&&this.props.thumbnailImages.length-1!==this.state.presentImageIndex?this.setState({disableNext:!1}):this.setState({disableNext:!0})}t.presentImageIndex!==this.state.presentImageIndex&&(0===this.state.presentImageIndex?this.setState({disablePrevious:!0}):this.state.presentImageIndex>0&&this.setState({disablePrevious:!1,disableNext:!1}),this.props.thumbnailImages.length-1===this.state.presentImageIndex?this.setState({disableNext:!0}):this.setState({disableNext:!1}))}},{key:"render",value:function(){var e=this,t=this.props.selectedImageName,s=I.a.t("device-toolbar.delete-confirm-msg",{imagename:"<b>"+t+"</b>"});return Object(N.jsxs)("div",{className:"thumbnailSection ".concat(this.state.isExpandView?"expand-view-height":"collapse-view-height"),children:[this.state.showExpandView&&Object(N.jsx)("div",{className:"expand-view-icon",children:Object(N.jsx)("i",{className:"fa-solid ".concat(this.state.isExpandView?"fa-down-left-and-up-right-to-center":"fa-up-right-and-down-left-from-center"),onClick:this.handelExpandView})}),Object(N.jsxs)("div",{className:"design-tb",children:[Object(N.jsx)(S.a,{ref:this.toast}),Object(N.jsx)(A.a,{title:I.a.t("device-toolbar.delete-image"),msg:s,icon:!0,visible:this.state.showDeleteDialog,onHide:function(){return e.deleteDialogWidget(!1)},onConfirm:function(){return e.handelDeleteImg(t)}}),this.state.isExpandView?Object(N.jsx)(T,{isExpandView:this.state.isExpandView,disablePrevious:this.state.disablePrevious,disableNext:this.state.disableNext,thumbnailImages:this.props.thumbnailImages,ids:this.props.ids,selection:this.props.selection,handlePreviousImage:this.handlePreviousImage,handleOnDragEnd:this.handleOnDragEnd,onKeyPressForAccessible:this.props.onKeyPressForAccessible,deleteDialogWidget:this.deleteDialogWidget,handleNextImage:this.handleNextImage,onClick:this.onClick}):Object(N.jsx)(R,{isExpandView:this.state.isExpandView,disablePrevious:this.state.disablePrevious,disableNext:this.state.disableNext,thumbnailImages:this.props.thumbnailImages,ids:this.props.ids,selection:this.props.selection,handlePreviousImage:this.handlePreviousImage,handleOnDragEnd:this.handleOnDragEnd,onKeyPressForAccessible:this.props.onKeyPressForAccessible,deleteDialogWidget:this.deleteDialogWidget,handleNextImage:this.handleNextImage,onClick:this.onClick})]})]})}}]),s}(r.Component),E=s(293),K=s(21),V=(s(306),s.p+"static/media/processing.d89dd7c6.svg"),M=s(308),_=(s(307),function(e){var t=Object(r.useState)(e.type),s=Object(b.a)(t,2),n=s[0],a=s[1],o=Object(r.useState)(e.content),i=Object(b.a)(o,2),l=i[0],c=i[1],d=Object(r.useState)(e.showContent),h=Object(b.a)(d,2),p=h[0],u=(h[1],Object(r.useState)(e.x)),g=Object(b.a)(u,2),f=g[0],j=g[1],C=Object(r.useState)(e.y),x=Object(b.a)(C,2),O=x[0],y=x[1],k=Object(r.useState)(e.w),w=Object(b.a)(k,2),A=w[0],D=w[1],T=Object(r.useState)(e.h),H=Object(b.a)(T,2),F=H[0],R=H[1],P=Object(r.useState)(!1),E=Object(b.a)(P,2),K=E[0],V=E[1],M=Object(r.useRef)(null);Object(r.useEffect)((function(){a(e.type),c(e.content),j(e.x),y(e.y),D(e.w),R(e.h)}),[e.isSimilarControl,e.selectedControlArr]);return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(S.a,{ref:M}),Object(N.jsx)("div",{className:"cd-container",children:Object(N.jsxs)("form",{className:"form",onSubmit:function(t){if(t.preventDefault(),1===e.selectedControlArr.length){var s={x:parseFloat(f),y:parseFloat(O),w:parseFloat(A),h:parseFloat(F)},a={controlType:n,controlContent:l,id:e.control.id,bounds:s};e.saveChanges(a)}else{var o={controlType:n};e.saveChanges(o)}},children:[Object(N.jsxs)("div",{className:"control-type d-flex",children:[Object(N.jsxs)("label",{className:"l-controlname",children:[I.a.t("control-details.type")," "]}),Object(N.jsxs)("select",{className:"controlname-input",defaultValue:n,onChange:function(e){return a(e.target.value)},children:[Object(N.jsx)("option",{name:"",value:0,children:I.a.t("control-details.select-control")}),m.map((function(e,t){return Object(N.jsx)("option",{value:e,children:e},t)}))]})]}),p&&Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)("div",{className:"control-content d-flex",children:[Object(N.jsxs)("label",{className:"l-content",children:[I.a.t("control-details.content")," "]}),Object(N.jsx)("input",{type:"text",label:"Control Content",className:"content-input",defaultValue:l,onChange:function(e){return c(e.target.value)},value:l})]}),Object(N.jsx)("div",{className:"moreLink",onClick:function(){return V(!K)},children:K?"show less":"show more"})]}),K&&Object(N.jsxs)("div",{className:"moreSection",children:[Object(N.jsxs)("div",{className:"d-flex coordinates",children:[Object(N.jsxs)("label",{className:"l-content",children:[I.a.t("control-details.bounds")," "]}),Object(N.jsx)("label",{className:"l-x",children:" X "}),Object(N.jsx)("input",{type:"text",className:"x-input",value:Math.round(f),onChange:function(e){return j(e.target.value)}}),Object(N.jsx)("label",{className:"l-y",children:" Y "}),Object(N.jsx)("input",{type:"text",className:"y-input",value:Math.round(O),onChange:function(e){return y(e.target.value)}})]}),Object(N.jsxs)("div",{className:"d-flex coordinates",children:[Object(N.jsxs)("label",{className:"l-content",style:{visibility:"hidden"},children:["Bounds"," "]}),Object(N.jsx)("label",{className:"l-w",children:" W "}),Object(N.jsx)("input",{type:"text",className:"w-input",value:Math.round(A),onChange:function(e){return D(e.target.value)}}),Object(N.jsx)("label",{className:"l-h",children:" H "}),Object(N.jsx)("input",{type:"text",className:"h-input",value:Math.round(F),onChange:function(e){return R(e.target.value)}})]})]}),Object(N.jsx)(v.a,{icon:"pi pi-check",type:"submit",className:"p-button-raised p-button-rounded save",label:"Save"})]})})]})}),B=function(e){return Object(N.jsx)(N.Fragment,{children:Object(N.jsx)("i",{className:"fa-solid fa-link link-hotSpot ".concat(e.classNames),onClick:e.handler})})},L=function(e){Object(l.a)(s,e);var t=Object(c.a)(s);function s(e){var i;return Object(o.a)(this,s),(i=t.call(this,e)).componentDidUpdate=function(e,t){if(e.selection!==i.props.selection)if(i.getControls(),i.props.getHotspot(i.props.selection),i.hotSpotRef.current.checked=!1,i.props.setHotSpotControl(null),i.props.selection===i.props.imageids[i.props.imageids.length-1].id){var s;i.setState({isHotspotDisable:!0}),i.props.imageids.map((function(e,t){e.id===i.props.selection&&(s=e.name)}));var n={name:s,navigation:null},o=y.a+"/application/"+i.props.appId+"/images/"+i.props.selection+"/metadata";h.a.put(o,n,{headers:{"Content-Type":"application/json","if-Match":"abcd"}}).then((function(){}))}else i.setState({isHotspotDisable:!1});if(e.parentSelectedControlArrState!==i.props.parentSelectedControlArrState){i.setState({selectedControlsArr:[]},(function(){return i.setState({selectedControlsArr:Object(a.a)(i.props.parentSelectedControlArrState)})}));var l=i.state.steps;i.props.parentSelectedControlArrState.map((function(e,t){l.map((function(t,s){t.id===e.id&&(t.isChecked=!0,i.setState({scrollViewIndex:s}))}))})),i.setState({steps:l})}if(i.scrollToBottom(),t.selectedControlsArr!==i.state.selectedControlsArr){if(i.state.selectedControlsArr.length>0){var c=i.isSimilarControlSelected();i.props.setSimilar(c),i.setActiveIndex(i.props.getcontrolname),c?i.setState({isSimilarDisable:!1,setControlType:i.props.getcontrolname}):(i.setState({isSimilarDisable:!0,setControlType:0,isSimilar:!1}),i.similarBox.current.checked=!1),i.setState({enableActions:!0})}else i.setState({enableActions:!1});1===i.state.selectedControlsArr.length?(i.similarBox.current.checked=!1,i.setState({showContent:!0})):i.setState({showContent:!1})}t.scrollViewIndex!==i.state.scrollViewIndex&&setTimeout((function(){var e=document.getElementById("checkbox_"+i.state.scrollViewIndex);null!==e&&e.scrollIntoView({behavior:"smooth",block:"center"})}),500)},i.setIndexArray=function(e){var t=i.state.activeIndex?Object(a.a)(i.state.activeIndex):[];0===t.length?t.push(e):-1===t.indexOf(e)&&t.push(e);i.setState({activeIndex:t})},i.toggleMinimized=function(){i.setState({minimized:!i.state.minimized}),i.props.onMinimize(!i.state.minimized)},i.updateCheckboxState=function(e){var t=i.state.steps;t.map((function(t,s){t.isChecked=e})),i.setState({steps:t})},i.updateSingleCheckbox=function(e,t){var s=i.state.steps;s.map((function(s,n){t===n&&(s.isChecked=e)})),i.setState({steps:s})},i.allClick=function(e){if(i.updateCheckboxState(e.target.checked),i.setState({isSimilarDisable:!0,isSimilar:!1}),i.setState({isallchecked:i.selectAllBox.current.checked}),i.similarBox.current.checked=!1,!1===i.state.isallchecked){var t=i.state.steps,s=[];t.map((function(e){i.state.stepTypeObjArr.map((function(t){e.type===t.name&&(!0===t.isChecked?(e.isChecked=!0,s.push(e)):e.isChecked=!1)}))})),i.props.onAllControlSelection(s)}else i.props.onAllControlSelection(null)},i.clearAllfromParent=function(){i.props.onAllControlSelection(null),i.setState({isSimilarDisable:!0,isallchecked:!1}),i.selectAllBox.current.checked=!1,i.similarBox.current.checked=!1;var e=i.state.steps;e.map((function(e,t){e.isChecked=!1})),i.setState({steps:e,isSimilar:!1,controlType:[],selectedControlsArr:[]}),i.props.setSimilar(!1)},i.handleDisableSimilar=function(e){0===i.state.controlType.length?(i.setState({controlType:[].concat(Object(a.a)(i.state.controlType),[e])}),i.setState({isSimilarDisable:!1})):i.state.controlType.find((function(t){return t.name!==e.name}))?i.setState({isSimilarDisable:!0}):i.setState({isSimilarDisable:!1})},i.handleCheckbox=function(e,t){if(i.updateSingleCheckbox(e.target.checked,t),e.target.checked)i.state.isSimilar&&i.setState({isSimilar:!1}),i.setState({clearall:!1}),i.setState({selectedControlIndex:t}),i.setState({ControlIndex:t}),i.setState({selectedControlsArr:[].concat(Object(a.a)(i.state.selectedControlsArr),[i.state.steps[t]])}),i.props.onControlSelect(i.state.steps[t]);else{var s=i.state.steps[t].id;if(i.state.selectedControlsArr.length>0){i.setState({isallchecked:!1}),i.selectAllBox.current.checked=!1;var n=i.state.selectedControlsArr.filter((function(e){return e.id!==s}));i.setState({selectedControlsArr:[]},(function(){return i.setState({selectedControlsArr:n})})),i.props.onAllControlSelection(n),0===n.length&&i.setState({isSimilarDisable:!0,controlType:[],selectedControlsArr:[]})}}},i.isSimilarControlSelected=function(){var e=i.state.selectedControlsArr,t=e[0].type;return e.every((function(e){return e.type===t}))},i.handleViewSimilar=function(e){if(i.setState({isSimilar:!i.state.isSimilar}),i.similarBox.current.checked){var t=i.state.selectedControlsArr[0],s=[];i.state.steps.map((function(e,n){t.type===e.type&&s.push(e)})),i.props.onAllControlSelection(s)}else{var n=i.state.steps;n.map((function(e,t){e.isChecked=!1})),i.setState({steps:n}),i.props.onAllControlSelection(null),i.setState({isSimilarDisable:!0})}},i.truncate=function(e){return void 0!==e&&null!==e?e.length>35?e.substring(0,35)+"...":e:""},i.setVisibleRight=function(e){i.setState({visibleRight:e})},i.rejectDelete=function(){i.toastRef.current.show({severity:"info",summary:"Rejected",detail:I.a.t("controls.reject-msg"),life:3e3})},i.showDeleteDialogWidget=function(e){i.setState({showDeleteDialog:e})},i.handelDeleteChange=function(){var e=i.state.steps;i.selectAllBox.current.checked?e=[]:i.state.selectedControlsArr.map((function(t,s){e.map((function(s,n){s.id===t.id&&e.splice(n,1)}))})),i.setState({selectedControlsArr:e}),e.map((function(e,t){return delete e.isChecked}));var t=y.a+"/application/"+i.props.appId+"/images/"+i.props.selection+"/labels";h.a.put(t,e,{headers:{"Content-Type":"application/json","if-Match":"abcd"}}).then((function(e){i.toastRef.current.show({severity:"success",summary:"Confirmed",detail:I.a.t("controls.delete-success-msg"),life:3e3}),i.getControls(),i.hotSpotRef.current.checked=!1,i.props.setHotSpotControl(null),i.clearAllfromParent(),i.setState({selectedControlsArr:[]})}))},i.handleUpdate=function(e){var t=i.state.selectedControlsArr,s=i.state.steps;t.map((function(n){s.map((function(s){1===t.length?s.id===n.id&&(s.content=e.controlContent,s.type=e.controlType,s.bounds=e.bounds):s.id===n.id&&(n.type=e.controlType)}))}));try{var n=y.a+"/application/"+i.props.appId+"/images/"+i.props.selection+"/labels";h.a.put(n,s,{headers:{"Content-Type":"application/json","if-Match":"abcd"}}).then((function(e){i.toastRef.current.show({severity:"success",summary:"Confirmed",detail:I.a.t("controls.update-success-msg"),life:3e3}),i.getControls(),i.clearAllfromParent(),i.setState({selectedControlsArr:[]})}))}catch(a){404===a.response.status?console.log("Resource could not be found!"):console.log(a.message)}i.setState({selectedControlsArr:t}),i.setVisibleRight(!1)},i.updateControlDetails=function(){1!==i.state.selectedControlsArr.length&&i.state.isSimilarDisable||i.setState({setControlType:i.state.selectedControlsArr[0].type}),i.setVisibleRight(!0)},i.addControlEnable=function(){i.props.setRegionFrom({add:!0,highlight:!1,reverseHighlight:!1}),i.props.setEnableCrop(!0)},i.toggleTypeSection=function(){i.setState({showControlSelection:!i.state.showControlSelection})},i.cancelTypeSection=function(){i.setState({showControlSelection:!1})},i.handleTypeSelectionCheckbox=function(e){var t=i.state.stepTypes,s=i.state.stepTypeObjArr,n=i.state.steps,o=i.state.selectedControlsArr;e.target.checked?(i.setState({isallchecked:!1}),i.selectAllBox.current.checked=!1,t.push(e.target.value),(t=Object(a.a)(new Set(t.sort()))).length===s.length&&(i.allComponentCheckbox.current.checked=!0,i.setState({allComponentChecked:!0}))):(t.map((function(s,n){e.target.value===s&&t.splice(n,1)})),n.map((function(t){t.type===e.target.value&&(t.isChecked=!1)})),o.map((function(t,s){t.type===e.target.value&&(o=o.filter((function(t){return t.type!==e.target.value})))})),i.setState({isSimilarDisable:!0,isallchecked:!1}),i.selectAllBox.current.checked=!1,i.similarBox.current.checked=!1,i.allComponentCheckbox.current.checked=!1,i.setState({allComponentChecked:!1})),s.map((function(t){t.name===e.target.value&&(t.isChecked=e.target.checked)})),i.setState({stepTypes:t.sort(),stepTypeObjArr:s,steps:n,selectedControlsArr:o}),i.props.setControlSteps(n),i.props.onAllControlSelection(o)},i.handleAllSelectionCheckbox=function(e){i.setState({allComponentChecked:e.target.checked});var t=i.state.stepTypes,s=i.state.steps,n=i.state.stepTypeObjArr;e.target.checked?(t=[],s.map((function(e){t.push(e.type)})),t=Object(a.a)(new Set(t)),n.map((function(e){e.isChecked=!0}))):(t=[],i.props.onAllControlSelection(null),i.setState({isSimilarDisable:!0,isallchecked:!1}),i.selectAllBox.current.checked=!1,i.similarBox.current.checked=!1,i.props.setControlSteps(s),n.map((function(e){e.isChecked=!1}))),i.setState({stepTypes:t.sort(),stepTypeObjArr:n})},i.resetToDefault=function(){i.clearAllfromParent(),i.setState({clearall:!0})},i.handleExpandAll=function(){i.setState({activeIndex:[]});var e=[];i.state.stepTypes.map((function(t,s){e.push(s)})),i.setState({activeIndex:e})},i.handleCollapseAll=function(){i.setState({activeIndex:[]})},i.removeChip=function(e){var t=i.state.stepTypes,s=i.state.stepTypeObjArr,n=i.state.steps,a=i.state.selectedControlsArr,o=s.findIndex((function(t){return t.name===e}));s[o].isChecked=!1,t.map((function(s,n){e===s&&t.splice(n,1)})),n.map((function(t){t.type===e&&(t.isChecked=!1)})),a.map((function(t,s){t.type===e&&(a=a.filter((function(t){return t.type!==e})))})),i.selectAllBox.current.checked=!1,i.similarBox.current.checked=!1,i.setState({stepTypeObjArr:s,allComponentChecked:!1,stepTypes:t,isSimilarDisable:!0,isallchecked:!1,steps:n,selectedControlsArr:a}),i.props.setControlSteps(n),i.props.onAllControlSelection(a)},i.handleToggleView=function(){i.setState({listView:!i.state.listView})},i.highlightHotSpot=function(e){if(e.target.checked){var t=!1;i.state.steps.map((function(e){e.isHotSpot&&(i.props.setHotSpotControl(e),t=!0)})),t||(i.toastRef.current.show({severity:"info",detail:I.a.t("controls.hotspot-highlight-error-msg"),life:3e3}),i.hotSpotRef.current.checked=!1)}else i.props.setHotSpotControl(null)},i.getHotspot=function(e){var t=y.a+"/application/"+i.props.appId+"/images/"+e+"/metadata";h.a.get(t).then((function(e){var t=e.data.navigation;if(null!==t){var s=Object.keys(t)[0],a=i.state.steps;a.map((function(e){e.id===s&&(e.isHotSpot=!0)})),i.setState(Object(n.a)({steps:[]},"steps",a))}})).catch((function(e){console.log(e)}))},i.handleHotspotCDOperation=function(e,t){if(i.props.selection!==i.props.imageids[i.props.imageids.length-1].id){var s,a,o,l,c,r=i.props.imageids,d=i.state.steps;r.map((function(e,t){e.id===i.props.selection&&(s=e.name,l=r[t+1],a=r[t+1].name)})),d[t].isHotSpot?(o={name:s,navigation:null},c=!1):(o={name:s,navigation:Object(n.a)({},e.id,{click:l.id})},c=!0);var p=y.a+"/application/"+i.props.appId+"/images/"+i.props.selection+"/metadata";h.a.put(p,o,{headers:{"Content-Type":"application/json","if-Match":"abcd"}}).then((function(){d.map((function(e){return e.isHotSpot=!1})),i.setState(Object(n.a)({steps:[]},"steps",d)),i.hotSpotRef.current.checked=!1,i.props.setHotSpotControl(null),i.getHotspot(i.props.selection),i.props.getHotspot(i.props.selection),c?(d[t].isHotSpot=!0,i.toastRef.current.show({severity:"success",summary:"Confirmed",detail:I.a.t("controls.hotspot-create-success-msg",{nextImageName:a}),life:3e3})):i.toastRef.current.show({severity:"success",summary:"Confirmed",detail:I.a.t("controls.hotspot-delete-success-msg"),life:3e3})})).catch((function(e){console.log(e),i.toastRef.current.show({severity:"info",summary:"Warning",detail:I.a.t("controls.hotspot-error-msg"),life:3e3})}))}else i.toastRef.current.show({severity:"info",detail:I.a.t("controls.no-image-for-hotspot"),life:3e3})},i.listViewTemplate=function(){return i.state.steps.map((function(e,t){if(i.state.stepTypes.includes(e.type))return Object(N.jsxs)("div",{className:"list-ctrl-items",onMouseOver:function(){return i.props.setOnhoverCoordinates(i.state.steps[t].bounds)},onMouseOut:function(){return i.props.setOnhoverCoordinates(null)},children:[Object(N.jsxs)("label",{htmlFor:"checkbox_"+t,children:[Object(N.jsx)("input",{id:"checkbox_"+t,type:"checkbox",className:"checkbox-style",checked:i.state.steps[t].isChecked,onChange:function(e){return i.handleCheckbox(e,t)},value:"",onKeyDown:function(e){return i.props.onKeyPressForAccessible(e)}}),Object(N.jsx)("span",{className:"list-controlType",children:e.type})," : ",i.truncate(e.content)]},t),Object(N.jsx)("div",{className:"hotspotSection",children:Object(N.jsx)(B,{handler:function(){return i.handleHotspotCDOperation(e,t)},index:t,controlStep:e,classNames:"".concat(e.isHotSpot?"hotspot-active":"")})})]})}))},i.state={steps:[],minimized:!1,isallchecked:!1,selectedControlIndex:-1,ControlIndex:-1,selectedControlsArr:[],isSimilar:!1,isSimilarDisable:!0,controlType:[],visibleRight:!1,enableActions:!1,showContent:!0,setControlType:0,showDeleteDialog:!1,stepTypes:[],stepTypeObjArr:[],activeIndex:null,showControlSelection:!1,isSelectallDisable:!0,allComponentChecked:!0,scrollViewIndex:null,clearall:!1,listView:!1,isHotSpotChecked:!1,isHotspotDisable:!1},i.stepsContainer=null,i.stepsContent=null,i.actionNames={},i.setVisibleRight=i.setVisibleRight.bind(Object(K.a)(i)),i.toastRef=Object(r.createRef)(),i.selectAllBox=Object(r.createRef)(),i.similarBox=Object(r.createRef)(),i.allComponentCheckbox=Object(r.createRef)(),i.hotSpotRef=Object(r.createRef)(),i}return Object(i.a)(s,[{key:"componentDidMount",value:function(){this.getControls(),this.props.getHotspot(this.props.selection),this.props.selection===this.props.imageids[this.props.imageids.length-1].id&&this.setState({isHotspotDisable:!0})}},{key:"setActiveIndex",value:function(e){var t=this;this.state.stepTypes.map((function(s,n){e===s&&t.setIndexArray(n)}))}},{key:"getControls",value:function(){var e=this;if(!this.props.selection)return[];var t=y.a+"/application/"+this.props.appId+"/images/"+this.props.selection+"/labels";h.a.get(t,{headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET","Access-Control-Expose-Headers":"Etag"}}).then((function(t){e.setState({steps:t.data,selectedControlIndex:-1,ControlIndex:-1}),t.data.length>1?e.setState({isSelectallDisable:!1}):e.setState({isSelectallDisable:!0});var s=t.data,n=[];s.map((function(e,t){e.isChecked=!1,e.isHotSpot=!1;var s={x:e.bounds.x,y:e.bounds.y,w:e.bounds.w,h:e.bounds.h};e.bounds=s,n.push(e.type)}));var a=[];n.forEach((function(e){a.indexOf(e)<0&&a.push(e)}));var o=a.sort();e.setState({stepTypes:o});var i=[];o.map((function(e){var t={};t.name=e,t.isChecked=!0,i.push(t)})),e.setState({stepTypeObjArr:i}),e.setState({steps:s}),e.props.setControlSteps(s),e.getHotspot(e.props.selection)})).catch((function(){console.log("Could not retrieve steps: "+e.props.selection)}))}},{key:"scrollToBottom",value:function(){null!==this.stepsContent&&(this.stepsContent.scrollTop=this.stepsContent.scrollHeight)}},{key:"addStep",value:function(e,t){var s=e===V?" cntls-processing":"";return Object(N.jsxs)("div",{className:"cntls-step"+s,title:t,children:[Object(N.jsx)("span",{className:"cntls-step-icon",children:Object(N.jsx)("img",{src:e,alt:e})}),!this.state.minimized&&Object(N.jsx)("span",{className:"cntls-step-label",children:t})]})}},{key:"groupViewTemplate",value:function(){var e=this;return Object(N.jsx)(M.a,{multiple:!0,activeIndex:this.state.activeIndex,onTabChange:function(t){return e.setState({activeIndex:t.index})},pt:{root:{role:"tablist"}},children:this.state.stepTypes.map((function(t,s){return Object(N.jsx)(M.b,{header:t,children:e.state.steps.map((function(s,n){if(s.type===t)return Object(N.jsxs)("div",{className:"ctrl-items",onMouseOver:function(){return e.props.setOnhoverCoordinates(e.state.steps[n].bounds)},onMouseOut:function(){return e.props.setOnhoverCoordinates(null)},children:[Object(N.jsxs)("label",{htmlFor:"checkbox_"+n,children:[Object(N.jsx)("input",{id:"checkbox_"+n,type:"checkbox",className:"checkbox-style",checked:e.state.steps[n].isChecked,onChange:function(t){return e.handleCheckbox(t,n)},value:"",onKeyDown:function(t){return e.props.onKeyPressForAccessible(t)}}),e.truncate(s.content)]},n),Object(N.jsx)("div",{className:"hotspotSection",children:Object(N.jsx)(B,{handler:function(){return e.handleHotspotCDOperation(s,n)},index:n,controlStep:s,classNames:"".concat(s.isHotSpot?"hotspot-active":"")})})]},n)}))},s)}))})}},{key:"render",value:function(){var e=this,t=this.state.minimized?" cntls-minimized":"";return Object(N.jsx)("div",{className:"cntls",children:Object(N.jsxs)("div",{className:"cntls-container"+t,ref:function(t){return e.stepsContainer=t},children:[Object(N.jsxs)("div",{className:"cntrl-header",children:[Object(N.jsxs)("div",{className:"d-flex cntrl-header-items",children:[Object(N.jsxs)("span",{tabIndex:"0",onClick:this.toggleTypeSection,className:"typeSectionToggle",onKeyDown:function(t){return e.props.onKeyPressForAccessible(t)},children:[I.a.t("controls.select-component"),Object(N.jsx)("i",{className:"pi pi-chevron-down",style:{fontSize:"10px",paddingLeft:"5px"}})]}),this.state.showControlSelection&&Object(N.jsxs)("div",{className:"selectComponentDiv",children:[Object(N.jsx)("span",{className:"cancelFIlterComponents",tabIndex:"0",onKeyDown:function(t){return e.props.onKeyPressForAccessible(t)},onClick:this.cancelTypeSection,children:Object(N.jsx)("i",{className:"pi pi-times",style:{fontSize:"12px"}})}),this.state.steps.length>1&&Object(N.jsxs)("p",{children:[Object(N.jsx)("input",{type:"checkbox",name:"checkbox",className:"component-checkbox",id:"selectAllComponent",value:"All",checked:this.state.allComponentChecked,ref:this.allComponentCheckbox,onChange:function(t){return e.handleAllSelectionCheckbox(t)},tabIndex:"0",onKeyDown:function(t){return e.props.onKeyPressForAccessible(t)}}),Object(N.jsx)("label",{htmlFor:"selectAllComponent",className:"component-label",children:"All"})]}),this.state.stepTypeObjArr.map((function(t,s){return Object(N.jsxs)("p",{children:[Object(N.jsx)("input",{type:"checkbox",name:"checkbox",className:"component-checkbox",id:s,value:t.name,checked:t.isChecked,onChange:function(t){return e.handleTypeSelectionCheckbox(t)},tabIndex:"0",onKeyDown:function(t){return e.props.onKeyPressForAccessible(t)}}),Object(N.jsx)("label",{htmlFor:s,className:"component-label",children:t.name})]},s)}))]}),Object(N.jsxs)("div",{style:{marginLeft:"auto"},children:[Object(N.jsx)("div",{className:"item",children:Object(N.jsx)("a",{href:"#",className:"toggle-view",title:"Toggle view",onClick:this.handleToggleView,tabIndex:0,onKeyDown:function(t){return e.props.onKeyPressForAccessible(t)},children:Object(N.jsx)("i",{className:"pi pi-list actions"})})}),Object(N.jsx)("div",{className:"item",children:Object(N.jsx)("a",{href:"#",className:"add",title:"Add control",onClick:this.addControlEnable,tabIndex:0,onKeyDown:function(t){return e.props.onKeyPressForAccessible(t)},children:Object(N.jsx)("i",{className:"pi pi-plus-circle actions"})})}),Object(N.jsx)("div",{className:"item",children:Object(N.jsx)("a",{href:"#",className:"update "+(this.state.enableActions?"":"disabled"),title:"Edit controls",onClick:this.updateControlDetails,tabIndex:0,onKeyDown:function(t){return e.props.onKeyPressForAccessible(t)},children:Object(N.jsx)("i",{className:"pi pi-pencil actions"})})}),Object(N.jsxs)("div",{className:"item",children:[Object(N.jsx)(S.a,{ref:this.toastRef}),Object(N.jsx)(E.a,{visible:this.state.showDeleteDialog,onHide:function(){return e.showDeleteDialogWidget(!1)},message:I.a.t("controls.delete-confirm-msg"),header:"Confirmation",icon:"pi pi-exclamation-triangle",accept:this.handelDeleteChange,reject:this.rejectDelete}),Object(N.jsx)("a",{href:"#",className:"delete "+(this.state.enableActions?"":"disabled"),title:"Delete controls",onClick:function(){return e.showDeleteDialogWidget(!0)},onKeyDown:function(t){return e.props.onKeyPressForAccessible(t)},children:Object(N.jsx)("i",{className:"pi pi-trash actions"})})]})]})]}),Object(N.jsxs)("div",{className:"d-flex cntrl-header-items",children:[Object(N.jsxs)("div",{className:"item",children:[Object(N.jsx)("input",{type:"checkbox",className:"checkbox-style",name:"Id",id:"selectAll",onChange:this.allClick,defaultChecked:this.state.isallchecked,ref:this.selectAllBox,disabled:this.state.isSelectallDisable,tabIndex:0,onKeyDown:function(t){return e.props.onKeyPressForAccessible(t)},"aria-label":"select all"}),Object(N.jsx)("span",{className:"caption",children:I.a.t("controls.select-all")})]}),Object(N.jsxs)("div",{className:"item",children:[Object(N.jsx)("input",{type:"checkbox",className:"checkbox-style",id:"similar",onChange:this.handleViewSimilar,disabled:this.state.isSimilarDisable,defaultChecked:this.state.isSimilar,ref:this.similarBox,tabIndex:0,onKeyDown:function(t){return e.props.onKeyPressForAccessible(t)},"aria-label":"similar"}),Object(N.jsx)("span",{className:"caption",children:I.a.t("controls.similar")})]}),Object(N.jsxs)("div",{className:"item",children:[Object(N.jsx)("input",{type:"checkbox",className:"checkbox-style",id:"hotSpot",defaultChecked:this.state.isHotSpotChecked,onChange:function(t){return e.highlightHotSpot(t)},ref:this.hotSpotRef,tabIndex:0,onKeyDown:function(t){return e.props.onKeyPressForAccessible(t)},"aria-label":"hotspot",disabled:this.state.isHotspotDisable}),Object(N.jsx)("span",{className:"caption",children:"Hotspot"})]}),Object(N.jsx)("div",{className:"item clear-link",children:Object(N.jsx)("span",{className:"clear "+(this.state.enableActions?"":"disabled"),title:"Clear all checkbox",onClick:this.resetToDefault,disabled:this.state.clearall,tabIndex:0,onKeyDown:function(t){return e.props.onKeyPressForAccessible(t)},children:I.a.t("controls.clear")})})]}),this.state.stepTypes.length>0&&!this.state.listView&&Object(N.jsxs)("div",{className:"d-flex cntrl-header-items",children:[Object(N.jsx)("span",{className:"accordion-expand-link",onClick:this.handleExpandAll,tabIndex:0,onKeyDown:function(t){return e.props.onKeyPressForAccessible(t)},children:I.a.t("controls.expand-all")}),Object(N.jsx)("span",{className:"accordion-collapse-link",onClick:this.handleCollapseAll,tabIndex:0,onKeyDown:function(t){return e.props.onKeyPressForAccessible(t)},children:I.a.t("controls.collapse-all")})]})]}),Object(N.jsx)("div",{className:"cntls-content",children:Object(N.jsxs)("div",{className:"cntrol-steps"+t,ref:function(t){return e.stepsContent=t},children:[Object(N.jsx)(x.a,{visible:this.state.visibleRight,position:"right",onHide:function(){return e.setVisibleRight(!1)},children:Object(N.jsx)("div",{className:"control-details-section",children:Object(N.jsx)(_,{type:this.state.setControlType,content:this.props.getcontent,confidence:this.props.getconfidence,x:this.props.getx,y:this.props.gety,h:this.props.geth,w:this.props.getw,control:this.props,handleControlnameChange:this.props.handleControlnameChange,handleContentChange:this.props.handleContentChange,handleConfidenceChange:this.props.handleConfidenceChange,handleX_CordinateChange:this.props.handleX_CordinateChange,handleY_CordinateChange:this.props.handleY_CordinateChange,handleW_CordinateChange:this.props.handleW_CordinateChange,handleH_CordinateChange:this.props.handleH_CordinateChange,setControlName:this.props.setControlName,isSimilarControl:this.props.isSimilarControl,selectedControlArr:this.state.selectedControlsArr,showContent:this.state.showContent,completeControl:this.props,saveChanges:this.handleUpdate})})}),this.state.steps.length>0&&(this.state.listView?this.listViewTemplate():this.groupViewTemplate())]})})]})})}}]),s}(r.Component),W=function(e){Object(l.a)(s,e);var t=Object(c.a)(s);function s(e){var i;return Object(o.a)(this,s),(i=t.call(this,e)).updateStateArr=function(e,t){i.state.selectedControlArr.length>0&&!t?i.setState({selectedControlArr:[].concat(Object(a.a)(i.state.selectedControlArr),[e])}):i.setState({selectedControlArr:[e]})},i.requestImageIds=function(e){var t=p+"/application/"+i.props.appId+"/images",s=setInterval((function(){Object(O.b)(t).then((function(t){if(i.setState({selectedId:t.data[i.state.imageFocusPoint].id,selectedImageName:t.data[i.state.imageFocusPoint].name}),t.data.every((function(e){return"completed"===e.status}))){clearInterval(s),i.setThumbnails(t.data),i.setState({isImgProcessing:"completed"});var n=[];t.data.map((function(e){n.push(e.id),i.requestImages(e.id)})),i.setState({ids:n}),e||i.toastRef.current.show({severity:"info",detail:I.a.t("virtual-client.cdis-info"),life:4e3})}else{i.setState({isImgProcessing:!0});var a=t.data.length-i.state.imageFocusPoint,o=t.data.filter((function(e){return"completed"===e.status})).length-i.state.imageFocusPoint;o=Math.floor(o/a*100),i.setState({totalImages:a,processedImagesLength:o})}})).catch((function(e){this.toastRef.current.show({severity:"info",detail:e.message,life:4e3}),clearInterval(s),setTimeout((function(){location.reload()}),5e3)}))}),3e3)},i.requestImages=function(e){i.getHotspot(e),i.setState({thumbnailImages:[]});var t=p+"/application/"+i.props.appId+"/images/"+e+"/screenshot";Object(O.a)(t).then((function(t){if(t.data){var s={};s[e]=t.data,i.setState({thumbnailImages:[].concat(Object(a.a)(i.state.thumbnailImages),[s])});var o=i.state.thumbnailImages,l=i.state.idThumbs,c=[];l.length===o.length&&(l.map((function(e){var t={};o.map((function(s){void 0!==s[e.id]&&(t[e.id]=s[e.id])})),c.push(t)})),i.setState(Object(n.a)({thumbnailImages:[]},"thumbnailImages",c)),i.imageFilesCopy=[])}})).catch((function(e){console.log(e),this.toastRef.current.show({severity:"info",detail:error.message,life:4e3})}))},i.onImgSelection=function(e){i.setState({imageid:e,selectedId:e,selectedControlCoordinatesArr:[]}),i.clearAll(),i.state.idThumbs.map((function(t){e===t.id&&i.setState({selectedImageName:t.name})}))},i.onAllControlSelection=function(e){i.setState({selectedControlCoordinatesArr:[]});var t=[],s=[];i.setState({selectedControlArr:[]}),null!==e&&e.map((function(e,n){return t.push(e.bounds),s.push(e),null})),i.setState({selectedControlCoordinatesArr:t}),i.setState({selectedControlArr:s})},i.onControlSelect=function(e,t){if(null===e)i.setState({selectedControlCoordinatesArr:[],selectedControlArr:[]});else{var s=e.bounds.x,n=e.bounds.y,o=e.bounds.w,l=e.bounds.h;i.setState({x1:s}),i.setState({y1:n}),i.setState({w1:o}),i.setState({h1:l}),i.setState({id:e.id}),i.setState({type:e.type}),i.setState({content:e.content}),i.setState({confidence:e.confidence}),i.state.selectedControlCoordinatesArr.length>0&&!t?i.setState({selectedControlCoordinatesArr:[].concat(Object(a.a)(i.state.selectedControlCoordinatesArr),[e.bounds]),selectedControlArr:[].concat(Object(a.a)(i.state.selectedControlArr),[e])}):i.setState({selectedControlCoordinatesArr:[e.bounds],selectedControlArr:[e]})}},i.handleControlnameChange=function(e){i.setState({controlname:e.target.value})},i.handleContentChange=function(e){i.setState({content:e.target.value})},i.handleConfidenceChange=function(e){i.setState({confidence:e.target.value})},i.handleX_CordinateChange=function(e){i.setState({x1:e.target.value})},i.handleY_CordinateChange=function(e){i.setState({y1:e.target.value})},i.handleW_CordinateChange=function(e){i.setState({w1:e.target.value})},i.handleH_CordinateChange=function(e){i.setState({h1:e.target.value})},i.setControlName=function(e){i.setState({name:e.target.value})},i.setControlSteps=function(e){i.setState({controlSteps:e})},i.setThumbnails=function(e){i.setState({idThumbs:e})},i.setSimilar=function(e){i.setState({isSimilarControl:e})},i.setAppState=function(){i.props.setDesignStatetoparent(!0)},i.setEnableCrop=function(e){i.setState({addControl:e})},i.setOnhoverCoordinates=function(e){null!==e?i.setState({onHoverControlCoordinates:{x:e.x,y:e.y,w:e.w,h:e.h}}):i.setState({onHoverControlCoordinates:{x:0,y:0,w:0,h:0}})},i.handleHotspotOnImageDelete=function(e){var t=i.state.idThumbs,s=t.findIndex((function(t){return t.id===e})),a=t[s-1],o=p+"/application/"+i.props.appId+"/images/"+a.id+"/metadata";h.a.get(o).then((function(o){var l=o.data.navigation;if(null!==l){var c=Object.values(Object.values(l)[0])[0],r=Object.keys(l)[0];if(c===e){var d=t[s+1],u={name:a.name,navigation:Object(n.a)({},r,{click:d.id})},m=p+"/application/"+i.props.appId+"/images/"+a.id+"/metadata";h.a.put(m,u,{headers:{"Content-Type":"application/json","if-Match":"abcd"}}).then((function(){i.toastRef.current.show({severity:"success",summary:"Confirmed",detail:I.a.t("controls.hotspot-updated-successfully"),life:3e3})}))}}})).catch((function(e){console.log(e)}))},i.filterSelection=function(e){var t,s=i.state.idThumbs;s[s.length-1].id!==e&&s[0].id!==e&&i.handleHotspotOnImageDelete(e);var a=i.state.thumbnailImages.filter((function(t){return Object.keys(t)[0]!==e})),o=i.state.idThumbs.filter((function(t){return t.id!==e}));i.setState((t={thumbnailImages:[]},Object(n.a)(t,"thumbnailImages",a),Object(n.a)(t,"idThumbs",o),t));var l=[];o.map((function(e){l.push(e.id),i.requestImages(e.id)})),i.setState({ids:l}),0===o.length?i.props.setDesignStatetoparent(!1):i.onImgSelection(o[0].id)},i.clearAll=function(){i.controlRef.current.clearAllfromParent()},i.refreshControlLabels=function(){i.controlRef.current.getControls()},i.setImageObjArr=function(e){i.setState({thumbnailImages:e})},i.setRegionFrom=function(e){i.setEnableCrop(!0),i.setState({selectRegionFrom:e})},i.setDragComplete=function(e){i.setState({dragComplete:e})},i.onKeyPressForAccessible=function(e){"Enter"===e.key&&e.target.click()},i.dialogWidget=function(e){i.setState({showConfirmDialog:e})},i.setHotSpotControl=function(e){i.setState({hotSpotControl:e})},i.getHotspot=function(e){var t=p+"/application/"+i.props.appId+"/images/"+e+"/metadata";h.a.get(t).then((function(t){var s=t.data.navigation,n={},o={};o.imageId=e,o.navigationData=t.data,n[e]=null!==s?Object.values(Object.values(s)[0])[0]:null;var l=i.state.allImageHotSpotIds;-1===i.state.allImageHotSpotDetails.findIndex((function(t){return t.imageId===e}))&&i.setState({allImageHotSpotDetails:[].concat(Object(a.a)(i.state.allImageHotSpotDetails),[o])}),l.map((function(t){void 0!==t[e]&&(t[e]=n[e])}))})).catch((function(e){console.log(e)}))},i.state={actionProcessing:!1,viewerVisibility:!0,isImgProcessing:"",status:"",ids:[],selectedId:null,appid:null,imageid:[],selectedControlArr:[],selectedControlCoordinatesArr:[],type:"",controlname:[],content:[],confidence:"",x1:[],y1:[],w1:[],h1:[],id:[],isSimilarControl:!1,controlSteps:[],idThumbs:[],thumbnailImages:[],addControl:!1,onHoverControlCoordinates:{x:0,y:0,w:0,h:0},selectRegionFrom:{add:!1,highlight:!1,reverseHighlight:!1},dragComplete:!1,selectedImageName:"",totalImages:0,processedImagesLength:0,imageFocusPoint:0,selectedStep:null,hotSpotControl:null,showConfirmDialog:!1,allImageHotSpotIds:[],allImageHotSpotDetails:[]},i.imageFilesCopy=[],i.controlRef=d.a.createRef(),i.toastRef=d.a.createRef(),i}return Object(i.a)(s,[{key:"componentDidMount",value:function(){var e=this;console.log(this.props);var t=[];this.imageFilesCopy=this.props.imageFiles;var s=this.imageFilesCopy.length;if(this.props.imageids.map((function(e){var s={};s[e.id]=null,t.push(s)})),this.setState({allImageHotSpotIds:t}),0===s&&0===this.props.imageids.length)this.props.setDesignStatetoparent(!1);else if(0===s){var n=this.props.imageids;this.setState({selectedId:n[0].id,selectedImageName:n[0].name}),this.setThumbnails(n),this.setState({isImgProcessing:"completed"});var a=[];n.map((function(t){a.push(t.id),e.requestImages(t.id)})),this.setState({ids:a})}else{var o=p+"/application/"+this.props.appId+"/images",i=new FormData,l=this.imageFilesCopy,c=this.props.imageids.length;this.setState({imageFocusPoint:c});for(var r=0;r<=l.length-1;r++)i.append("file",l[r]);this.imageFilesCopy=[],Object(O.d)(o,i).then((function(t){t.data?e.requestImageIds(!0):e.requestImageIds(!1)})).catch((function(e){this.requestImageIds(!1)}))}}},{key:"render",value:function(){var e=this;return 0===this.state.idThumbs.length?Object(N.jsx)("div",{className:"card imageprocessCard",children:0===this.state.processedImagesLength?Object(N.jsxs)("div",{className:"ac-pb",children:[Object(N.jsx)("div",{className:"ac-pb-text",children:I.a.t("device-viewer.loader")}),Object(N.jsx)("div",{className:"ac-pb-container",children:Object(N.jsx)("div",{className:"ac-pb-content"})})]}):Object(N.jsx)(C.a,{value:this.state.processedImagesLength,displayValueTemplate:function(t){var s=t*e.state.totalImages;return s=Math.round(s/100),Object(N.jsxs)("div",{className:"loader-label",children:[s," / ",Object(N.jsxs)("b",{children:[" ",e.state.totalImages," "]})," processed"]})}})}):Object(N.jsxs)("div",{className:"vc",children:[Object(N.jsx)(S.a,{ref:this.toastRef}),Object(N.jsx)(E.a,{message:"Do you want to overwrite the existing hotspot?",icon:"pi pi-exclamation-triangle",visible:this.state.showConfirmDialog,onHide:function(){return e.dialogWidget(!1)},accept:function(){return e.handleHotSpotService(!0,!1)}}),Object(N.jsxs)("div",{className:"backLink",children:[Object(N.jsx)("i",{className:"pi pi-arrow-left home-icon",onClick:this.setAppState,tabIndex:0,onKeyDown:function(t){return e.onKeyPressForAccessible(t)}}),Object(N.jsx)("span",{className:"app-name",children:this.props.appName})," (",Object(N.jsx)("span",{children:this.state.selectedImageName.trim()}),")"]}),Object(N.jsxs)("div",{className:"vc-container",children:[Object(N.jsxs)("div",{className:"vc-content",children:[Object(N.jsx)(k,{visibility:this.state.viewerVisibility,actionProcessing:this.state.actionProcessing,onIncomingScreenshot:this.onIncomingScreenshot,onControlSelect:this.onControlSelect,selection:this.state.selectedId,selectedControlCoordinatesArr:this.state.selectedControlCoordinatesArr,updateParentControlState:this.updateStateArr,getcontrolname:this.state.type,getcontent:this.state.content,getconfidence:this.state.confidence,getx:this.state.x1,gety:this.state.y1,getw:this.state.w1,geth:this.state.h1,id:this.state.id,handleControlnameChange:this.handleControlnameChange,handleContentChange:this.handleContentChange,handleConfidenceChange:this.handleConfidenceChange,handleX_CordinateChange:this.handleX_CordinateChange,handleY_CordinateChange:this.handleY_CordinateChange,handleW_CordinateChange:this.handleW_CordinateChange,handleH_CordinateChange:this.handleH_CordinateChange,setControlName:this.setControlName,isSimilarControl:this.state.isSimilarControl,appId:this.props.appId,controlSteps:this.state.controlSteps,thumbnailImages:this.state.thumbnailImages,setEnableCrop:this.setEnableCrop,addControl:this.state.addControl,setControlSteps:this.setControlSteps,clearAllControls:this.clearAll,setOnhoverCoordinates:this.setOnhoverCoordinates,onHoverControlCoordinates:this.state.onHoverControlCoordinates,onAllControlSelection:this.onAllControlSelection,onNewSelection:this.onImgSelection,selectRegionFrom:this.state.selectRegionFrom,setRegionFrom:this.setRegionFrom,enableRegionFeature:this.enableRegionFeature,setDragComplete:this.setDragComplete,dragComplete:this.state.dragComplete,refreshControlLabels:this.refreshControlLabels,hotSpotControl:this.state.hotSpotControl}),Object(N.jsx)(P,{selection:this.state.selectedId,onNewSelection:this.onImgSelection,ids:this.state.ids,appId:this.props.appId,thumbnailImages:this.state.thumbnailImages,filterSelection:this.filterSelection,imageids:this.state.idThumbs,setImageObjArr:this.setImageObjArr,selectedImageName:this.state.selectedImageName,onKeyPressForAccessible:this.onKeyPressForAccessible,imageFocusPoint:this.state.imageFocusPoint,setThumbnails:this.setThumbnails,allImageHotSpotIds:this.state.allImageHotSpotIds,allImageHotSpotDetails:this.state.allImageHotSpotDetails,getHotspot:this.getHotspot})]}),Object(N.jsx)(L,{onMinimize:this.onTestStepsMinimize,selection:this.state.selectedId,onControlSelect:this.onControlSelect,onAllControlSelection:this.onAllControlSelection,getcontrolname:this.state.type,getcontent:this.state.content,getconfidence:this.state.confidence,getx:this.state.x1,gety:this.state.y1,getw:this.state.w1,geth:this.state.h1,id:this.state.id,handleControlnameChange:this.handleControlnameChange,handleContentChange:this.handleContentChange,handleConfidenceChange:this.handleConfidenceChange,handleX_CordinateChange:this.handleX_CordinateChange,handleY_CordinateChange:this.handleY_CordinateChange,handleW_CordinateChange:this.handleW_CordinateChange,handleH_CordinateChange:this.handleH_CordinateChange,setControlName:this.setControlName,setSwitch:this.setSwitch,parentSelectedControlArrState:this.state.selectedControlArr,setSimilar:this.setSimilar,appId:this.props.appId,setControlSteps:this.setControlSteps,setEnableCrop:this.setEnableCrop,ref:this.controlRef,setOnhoverCoordinates:this.setOnhoverCoordinates,selectRegionFrom:this.state.selectRegionFrom,setRegionFrom:this.setRegionFrom,enableRegionFeature:this.enableRegionFeature,onKeyPressForAccessible:function(t){return e.onKeyPressForAccessible(t)},selectedStep:this.state.selectedStep,imageids:this.state.idThumbs,setHotSpotControl:this.setHotSpotControl,getHotspot:this.getHotspot})]})]})}}]),s}(r.Component);t.default=W}}]);
//# sourceMappingURL=4.71689bf2.chunk.js.map